#!/usr/bin/env bash
set -e

# Prevent infinite loop if hook triggered by automated CI.
if [[ -n "$CI" ]]; then
  exit 0
fi

# Use the lightweight CI target for quick feedback before pushing.
echo "ğŸš¦ Pre-push: running lightweight local CI (make ci-lite)â€¦"

if ! make ci-lite; then
  echo "âŒï¸ Local CI failed â€“ push aborted. Fix issues and commit again."
  exit 1
fi

echo "âœ… ci-lite passed â€“ proceeding with push." 