### M1.11.4 Â· UI â€“ Sections 5 Goal Setup & 6 Medical History

**Epic:** 1.11 Onboarding Intake Surveys\
**Status:** ðŸŸ¡ Planned

---

## ðŸŽ¯ Goal

Develop final onboarding screens allowing users to set outcome goals,
energy-rating cadence, and enter biometrics/medical history with numeric inputs
and checkbox grids.

## âœ… Success Criteria

- Numeric inputs restrict to valid ranges (weight 50â€“600 lb, BP 60â€“200 mmHg).
- Scrolling checkbox grid maintains 60 fps on devices â‰¥ iPhone SE.
- Partial progress is saved to local storage every 5 s.
- Form auto-restores after app restart.

## ðŸ“‹ Milestone Breakdown

| Task ID | Description                                             | Est. Hrs | Status      |
| ------- | ------------------------------------------------------- | -------- | ----------- |
| T1      | Build `GoalSetupPage` with dynamic target field         | 4h       | âœ… Complete |
| T2      | Build `MedicalHistoryPage` with paginated checkbox grid | 4h       | âœ… Complete |
| T3      | Implement numeric & range validation                    | 3h       | âœ… Complete |
| T4      | Persist draft to `shared_preferences`                   | 2h       | ðŸŸ¡ Planned  |

## ðŸ“¦ Deliverables

- `goal_setup_page.dart`, `medical_history_page.dart`.
- `validators/number_range_validator.dart`.
- Integration test: kill & relaunch app, verify restore.

## ðŸ”§ Implementation Details

- Use `TextInputType.numberWithOptions` for iOS numeric keypad.
- Checkbox grid: `SliverGrid` inside `CustomScrollView`.
- Save draft JSON using `shared_preferences` keyed by `userId`.
- Enums for schedule (`daily`, `every_2_days`, â€¦) match DB enum.
- Provide helper text linking to privacy policy.

## ðŸ§ª Testing Approach

- Widget tests for validators with edge values.
- Integration test using `IntegrationTestWidgetsFlutterBinding`.
- Performance trace in profile mode.

## ðŸ“œ Acceptance Criteria Checklist

- [ ] Edge cases blocked (weight <50 lb â†’ error).
- [ ] Draft restores after cold restart.
- [ ] All fields map to model enums.

## ðŸ”— Dependencies / Notes

- Depends on validators in `core/validators`.
- Works offline; submission handled next milestone.
